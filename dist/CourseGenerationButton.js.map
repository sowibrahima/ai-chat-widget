{"version":3,"file":"CourseGenerationButton.js","names":["_react","_interopRequireWildcard","require","_CourseGenerationModal","_interopRequireDefault","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","CourseGenerationButton","_ref","buttonText","buttonIcon","buttonClassName","apiUrl","uploadUrl","maxFileSizeMB","onSuccess","onError","showModal","setShowModal","useState","handleGenerate","_ref2","file","instructions","formData","FormData","append","uploadResponse","fetch","method","body","credentials","headers","getCsrfToken","ok","errorData","json","Error","error","uploadResult","jobResponse","JSON","stringify","job_type","input_data","file_id","jobResult","jobId","id","message","console","cookies","document","cookie","split","name","value","trim","csrfMeta","querySelector","getAttribute","createElement","Fragment","className","onClick","title","style","marginRight","isOpen","onClose","onGenerate"],"sources":["../src/CourseGenerationButton.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport CourseGenerationModal from './CourseGenerationModal';\nimport './AIChatWidget.css';\n\n/**\n * CourseGenerationButton\n * - Simple button component that opens the course generation modal\n * - Handles the modal state and API calls\n * - Can be easily imported and used in Tutor plugin slots\n */\nexport default function CourseGenerationButton({\n  buttonText = \"AI Generate\",\n  buttonIcon = \"ðŸª„\",\n  buttonClassName = \"btn btn-primary\",\n  apiUrl = \"/api/ai-assistant/generation/jobs\",\n  uploadUrl = \"/api/ai-assistant/upload\",\n  maxFileSizeMB = 50,\n  onSuccess = () => {},\n  onError = () => {},\n}) {\n  const [showModal, setShowModal] = useState(false);\n\n  const handleGenerate = async ({ file, instructions }) => {\n    try {\n      // First upload the PDF file\n      const formData = new FormData();\n      formData.append('file', file);\n      \n      const uploadResponse = await fetch(uploadUrl, {\n        method: 'POST',\n        body: formData,\n        credentials: 'same-origin',\n        headers: {\n          'X-CSRFToken': getCsrfToken(),\n        },\n      });\n\n      if (!uploadResponse.ok) {\n        const errorData = await uploadResponse.json();\n        throw new Error(errorData.error || 'Failed to upload file');\n      }\n\n      const uploadResult = await uploadResponse.json();\n      \n      // Then create the generation job\n      const jobResponse = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': getCsrfToken(),\n        },\n        credentials: 'same-origin',\n        body: JSON.stringify({\n          job_type: 'course_creation',\n          input_data: {\n            file_id: uploadResult.file_id,\n            instructions: instructions,\n          },\n        }),\n      });\n\n      if (!jobResponse.ok) {\n        const errorData = await jobResponse.json();\n        throw new Error(errorData.error || 'Failed to create generation job');\n      }\n\n      const jobResult = await jobResponse.json();\n      \n      // Call success callback\n      onSuccess({\n        jobId: jobResult.id,\n        message: 'Course generation started successfully! You will be notified when it completes.',\n      });\n\n    } catch (error) {\n      console.error('Course generation error:', error);\n      onError(error);\n      throw error; // Re-throw so modal can handle it\n    }\n  };\n\n  // Helper function to get CSRF token\n  const getCsrfToken = () => {\n    const cookies = document.cookie.split(';');\n    for (let cookie of cookies) {\n      const [name, value] = cookie.trim().split('=');\n      if (name === 'csrftoken') {\n        return value;\n      }\n    }\n    // Fallback: try to get from meta tag\n    const csrfMeta = document.querySelector('meta[name=\"csrf-token\"]');\n    return csrfMeta ? csrfMeta.getAttribute('content') : '';\n  };\n\n  return (\n    <>\n      <button\n        className={buttonClassName}\n        onClick={() => setShowModal(true)}\n        title=\"Generate course content with AI\"\n        aria-label=\"Generate course content with AI\"\n      >\n        <span className=\"icon\" style={{ marginRight: '8px' }}>\n          {buttonIcon}\n        </span>\n        {buttonText}\n      </button>\n\n      <CourseGenerationModal\n        isOpen={showModal}\n        onClose={() => setShowModal(false)}\n        onGenerate={handleGenerate}\n        maxFileSizeMB={maxFileSizeMB}\n      />\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]}