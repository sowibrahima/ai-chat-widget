{"version":3,"file":"AIChatWidget.js","names":["_react","_interopRequireWildcard","require","_classnames","_interopRequireDefault","_hooks","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","AIChatWidget","_ref","chatAppData","title","placeholder","apiUrl","disabled","sendMessage","isLoading","error","useAIChat","open","setOpen","useState","busy","setBusy","lines","setLines","inputRef","useRef","canSend","useMemo","append","text","role","arguments","length","undefined","prev","id","String","formatResponse","res","message","metadata","JSON","stringify","formatError","detail","handleSend","v","current","value","trim","errorMessage","handleKeyDown","key","shiftKey","preventDefault","createElement","className","onClick","map","line","ref","onKeyDown","rows"],"sources":["../src/AIChatWidget.jsx"],"sourcesContent":["import React, { useMemo, useRef, useState } from 'react';\nimport classNames from 'classnames';\nimport { useAIChat } from './data/hooks';\nimport './AIChatWidget.css';\n\n/**\n * AIChatWidget\n * - Clean and modern AI chat component\n * - Simple but professional design\n */\nexport default function AIChatWidget({\n  chatAppData = {},\n}) {\n  const {\n    title = 'AI Assistant',\n    placeholder = 'Ask me anything‚Ä¶',\n    apiUrl = '/api/ai-assistant/chat',\n    disabled = false,\n  } = chatAppData;\n\n  const { sendMessage, isLoading, error } = useAIChat(apiUrl);\n  const [open, setOpen] = useState(false);\n  const [busy, setBusy] = useState(false);\n  const [lines, setLines] = useState([]);\n  const inputRef = useRef(null);\n\n  const canSend = useMemo(() => !disabled && !busy, [disabled, busy]);\n\n  function append(text, role = 'system') {\n    setLines(prev => [...prev, { id: String(prev.length + 1), role, text }]);\n  }\n\n  function formatResponse(res) {\n    if (typeof res === 'string') {\n      return res;\n    }\n    \n    // Handle structured response with message field\n    if (res?.message) {\n      return res.message;\n    }\n    \n    // Handle error responses with metadata\n    if (res?.metadata?.error) {\n      return res.metadata.error;\n    }\n    \n    // Fallback to text field or stringify\n    return res?.text || JSON.stringify(res);\n  }\n\n  function formatError(error) {\n    // Try to extract meaningful error message\n    if (typeof error === 'string') {\n      return error;\n    }\n    \n    if (error?.message) {\n      return error.message;\n    }\n    \n    if (error?.detail) {\n      return error.detail;\n    }\n    \n    return 'Something went wrong. Please try again.';\n  }\n\n  async function handleSend() {\n    const v = (inputRef.current?.value || '').trim();\n    if (!v || !canSend) return;\n    append(`You: ${v}`, 'user');\n    inputRef.current.value = '';\n    setBusy(true);\n    try {\n      const res = await sendMessage(v);\n      const text = formatResponse(res);\n      append(text, 'assistant');\n    } catch (e) {\n      const errorMessage = formatError(e);\n      append(errorMessage, 'error');\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  function handleKeyDown(e) {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  }\n\n  if (!open) {\n    return (\n      <div className=\"ai-chat-widget-fab\">\n        <button\n          className=\"ai-chat-widget-fab-button\"\n          onClick={() => setOpen(true)}\n          title={title}\n          aria-label={`Open ${title}`}\n        >\n          ü§ñ\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"ai-chat-widget-container\">\n      <div className=\"ai-chat-widget\">\n        <div className=\"ai-chat-widget-header\">\n          <div className=\"ai-chat-widget-title-section\">\n            <div className=\"ai-chat-widget-icon\">ü§ñ</div>\n            <h3 className=\"ai-chat-widget-title\">{title}</h3>\n          </div>\n          <button\n            className=\"ai-chat-widget-close\"\n            onClick={() => setOpen(false)}\n            title=\"Close\"\n            aria-label=\"Close chat\"\n          >\n            ‚úï\n          </button>\n        </div>\n        \n        <div className=\"ai-chat-widget-body\">\n          {lines.length === 0 && (\n            <div className=\"ai-chat-widget-welcome\">\n              <div className=\"welcome-icon\">üëã</div>\n              <p>Hi! I'm here to help. Ask me anything!</p>\n            </div>\n          )}\n          {lines.map(line => (\n            <div key={line.id} className={`ai-chat-widget-line ai-chat-widget-line-${line.role}`}>\n              {line.text}\n            </div>\n          ))}\n          {busy && (\n            <div className=\"ai-chat-widget-line ai-chat-widget-line-assistant ai-chat-widget-typing\">\n              <div className=\"typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n              </div>\n              Thinking...\n            </div>\n          )}\n        </div>\n        \n        <div className=\"ai-chat-widget-footer\">\n          {error && (\n            <div className=\"ai-chat-widget-error\">\n              {error}\n            </div>\n          )}\n          <div className=\"ai-chat-widget-input-container\">\n            <textarea\n              ref={inputRef}\n              className=\"ai-chat-widget-input\"\n              placeholder={placeholder}\n              disabled={!canSend}\n              onKeyDown={handleKeyDown}\n              rows={2}\n            />\n            <button\n              className={`ai-chat-widget-send ${!canSend ? 'disabled' : ''}`}\n              onClick={handleSend}\n              disabled={!canSend}\n              title=\"Send message\"\n              aria-label=\"Send message\"\n            >\n              {busy ? '‚è≥' : '‚û§'}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]}