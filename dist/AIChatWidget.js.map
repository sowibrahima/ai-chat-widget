{"version":3,"file":"AIChatWidget.js","names":["_react","_interopRequireWildcard","require","_classnames","_interopRequireDefault","_reactMarkdown","_hooks","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_extends","assign","bind","arguments","length","apply","IconBot","_ref","size","props","createElement","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x","y","rx","d","cx","cy","IconClose","_ref2","x1","y1","x2","y2","IconSend","_ref3","IconSpinner","_ref4","className","opacity","AIChatWidget","_ref5","chatAppData","title","placeholder","apiUrl","disabled","sendMessage","sendMessageStream","isLoading","error","useAIChat","open","setOpen","useState","busy","setBusy","lines","setLines","streamingMessageId","setStreamingMessageId","hasFirstAIResponse","setHasFirstAIResponse","inputRef","useRef","inputValue","setInputValue","messagesEndRef","canSend","useMemo","markdownComponents","h1","_ref6","children","h2","_ref7","h3","_ref8","h4","_ref9","h5","_ref0","h6","_ref1","code","_ref10","ul","_ref11","ol","_ref12","li","_ref13","p","_ref14","scrollToBottom","current","scrollIntoView","behavior","useEffect","append","text","role","undefined","id","messageId","String","Date","now","Math","random","prev","updateMessage","map","line","formatResponse","res","message","metadata","JSON","stringify","formatError","detail","handleSend","v","trim","assistantMessageId","streamedText","chunk","errorMessage","handleKeyDown","key","shiftKey","preventDefault","handleInputChange","target","value","textarea","style","min","scrollHeight","onClick","components","ref","onKeyDown","onChange","rows"],"sources":["../src/AIChatWidget.jsx"],"sourcesContent":["import React, { useMemo, useRef, useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport ReactMarkdown from 'react-markdown';\nimport { useAIChat } from './data/hooks';\nimport './AIChatWidget.css';\n\n// Icon components (minimal SVGs)\nconst IconBot = ({ size = 20, ...props }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\" {...props}>\n    <rect x=\"5\" y=\"8\" width=\"14\" height=\"10\" rx=\"4\"></rect>\n    <path d=\"M12 4v4\"></path>\n    <circle cx=\"8.5\" cy=\"12.5\" r=\"1\"></circle>\n    <circle cx=\"15.5\" cy=\"12.5\" r=\"1\"></circle>\n  </svg>\n);\nconst IconClose = ({ size = 18, ...props }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.8\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\" {...props}>\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n  </svg>\n);\nconst IconSend = ({ size = 16, ...props }) => (\n  <svg width={size} height={size} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\" {...props}>\n    <path d=\"M22 2L11 13\"></path>\n    <path d=\"M22 2L15 22L11 13L2 9L22 2Z\"></path>\n  </svg>\n);\nconst IconSpinner = ({ size = 16, ...props }) => (\n  <svg className=\"spinner\" width={size} height={size} viewBox=\"0 0 24 24\" aria-hidden=\"true\" {...props}>\n    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"3\" fill=\"none\" opacity=\"0.2\" />\n    <path d=\"M22 12a10 10 0 0 1-10 10\" stroke=\"currentColor\" strokeWidth=\"3\" fill=\"none\" />\n  </svg>\n);\n\n/**\n * AIChatWidget\n * - Clean and modern AI chat component\n * - Simple but professional design\n */\nexport default function AIChatWidget({\n  chatAppData = {},\n}) {\n  const {\n    title = 'AI Assistant',\n    placeholder = 'Ask me anything…',\n    apiUrl = '/api/ai-assistant/chat',\n    disabled = false,\n  } = chatAppData;\n\n  const { sendMessage, sendMessageStream, isLoading, error } = useAIChat(apiUrl);\n  const [open, setOpen] = useState(false);\n  const [busy, setBusy] = useState(false);\n  const [lines, setLines] = useState([]);\n  const [streamingMessageId, setStreamingMessageId] = useState(null);\n  const [hasFirstAIResponse, setHasFirstAIResponse] = useState(false);\n  const inputRef = useRef(null);\n  const [inputValue, setInputValue] = useState('');\n  const messagesEndRef = useRef(null);\n\n  const canSend = useMemo(() => !disabled && !busy, [disabled, busy]);\n\n  // Custom components for ReactMarkdown\n  const markdownComponents = {\n    // Ensure headings have proper styling\n    h1: ({ children }) => <h1 className=\"markdown-h1\">{children}</h1>,\n    h2: ({ children }) => <h2 className=\"markdown-h2\">{children}</h2>,\n    h3: ({ children }) => <h3 className=\"markdown-h3\">{children}</h3>,\n    h4: ({ children }) => <h4 className=\"markdown-h4\">{children}</h4>,\n    h5: ({ children }) => <h5 className=\"markdown-h5\">{children}</h5>,\n    h6: ({ children }) => <h6 className=\"markdown-h6\">{children}</h6>,\n    // Style code blocks\n    code: ({ children, className }) => (\n      <code className={`markdown-code ${className || ''}`}>{children}</code>\n    ),\n    // Style lists\n    ul: ({ children }) => <ul className=\"markdown-ul\">{children}</ul>,\n    ol: ({ children }) => <ol className=\"markdown-ol\">{children}</ol>,\n    li: ({ children }) => <li className=\"markdown-li\">{children}</li>,\n    // Style paragraphs\n    p: ({ children }) => <p className=\"markdown-p\">{children}</p>,\n  };\n\n  // Auto-scroll to bottom when new messages are added\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [lines, busy]);\n\n  function append(text, role = 'system', id = null) {\n    const messageId = id || String(Date.now() + Math.random());\n    setLines(prev => [...prev, { id: messageId, role, text }]);\n    return messageId;\n  }\n\n  function updateMessage(id, text) {\n    setLines(prev => prev.map(line => \n      line.id === id ? { ...line, text } : line\n    ));\n  }\n\n  function formatResponse(res) {\n    if (typeof res === 'string') {\n      return res;\n    }\n    \n    // Handle structured response with message field\n    if (res?.message) {\n      return res.message;\n    }\n    \n    // Handle error responses with metadata\n    if (res?.metadata?.error) {\n      return res.metadata.error;\n    }\n    \n    // Fallback to text field or stringify\n    return res?.text || JSON.stringify(res);\n  }\n\n  function formatError(error) {\n    // Try to extract meaningful error message\n    if (typeof error === 'string') {\n      return error;\n    }\n    \n    if (error?.message) {\n      return error.message;\n    }\n    \n    if (error?.detail) {\n      return error.detail;\n    }\n    \n    return 'Something went wrong. Please try again.';\n  }\n\n  async function handleSend() {\n    const v = inputValue.trim();\n    if (!v || !canSend) return;\n    \n    // Add user message\n    append(v, 'user');\n    setInputValue('');\n    setBusy(true);\n    \n    try {\n      // Try streaming first, fallback to regular if not available\n      if (sendMessageStream) {\n        const assistantMessageId = append('', 'assistant');\n        setStreamingMessageId(assistantMessageId);\n        let streamedText = '';\n        \n        await sendMessageStream(v, (chunk) => {\n          streamedText += chunk;\n          updateMessage(assistantMessageId, streamedText);\n        });\n        \n        setStreamingMessageId(null);\n        setHasFirstAIResponse(true);\n      } else {\n        // Fallback to regular message\n        const res = await sendMessage(v);\n        const text = formatResponse(res);\n        append(text, 'assistant');\n        setHasFirstAIResponse(true);\n      }\n    } catch (e) {\n      const errorMessage = formatError(e);\n      append(errorMessage, 'error');\n      setStreamingMessageId(null);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  function handleKeyDown(e) {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  }\n\n  function handleInputChange(e) {\n    setInputValue(e.target.value);\n    // Auto-resize textarea\n    const textarea = e.target;\n    textarea.style.height = 'auto';\n    textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';\n  }\n\n  if (!open) {\n    return (\n      <div className=\"ai-chat-widget-fab\">\n        <button\n          className=\"ai-chat-widget-fab-button\"\n          onClick={() => setOpen(true)}\n          title={title}\n          aria-label={`Open ${title}`}\n        >\n          <IconBot size={22} />\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"ai-chat-widget-container\">\n      <div className=\"ai-chat-widget\">\n        <div className=\"ai-chat-widget-header\">\n          <div className=\"ai-chat-widget-title-section\">\n            <div className=\"ai-chat-widget-icon\"><IconBot size={18} /></div>\n            <h3 className=\"ai-chat-widget-title\">{title}</h3>\n          </div>\n          <button\n            className=\"ai-chat-widget-close\"\n            onClick={() => setOpen(false)}\n            title=\"Close\"\n            aria-label=\"Close chat\"\n          >\n            <IconClose size={18} />\n          </button>\n        </div>\n        \n        <div className=\"ai-chat-widget-body\">\n          {lines.length === 0 && (\n            <div className=\"ai-chat-widget-welcome\">\n              <div className=\"welcome-icon\"><IconBot size={40} /></div>\n              <p>Hi! I'm here to help. Ask me anything!</p>\n            </div>\n          )}\n          {lines.map(line => (\n            <div key={line.id} className={`ai-chat-widget-line ai-chat-widget-line-${line.role}`}>\n              <div className=\"message-content\">\n                <ReactMarkdown components={markdownComponents}>\n                  {line.text || ''}\n                </ReactMarkdown>\n              </div>\n              {streamingMessageId === line.id && (\n                <span className=\"streaming-cursor\">▊</span>\n              )}\n            </div>\n          ))}\n          {busy && !streamingMessageId && (\n            <div className=\"ai-chat-widget-line ai-chat-widget-line-assistant ai-chat-widget-typing\">\n              <div className=\"typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n              </div>\n              Thinking...\n            </div>\n          )}\n          {hasFirstAIResponse && (\n            <div className=\"ai-chat-widget-disclaimer\">\n              <p>\n                L'AI peut faire des erreurs. Veuillez vérifier les informations importantes.\n              </p>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n        \n        <div className=\"ai-chat-widget-footer\">\n          {error && (\n            <div className=\"ai-chat-widget-error\">\n              {error}\n            </div>\n          )}\n          <div className=\"ai-chat-widget-input-container\">\n            <div className=\"ai-chat-widget-input-wrapper\">\n              <textarea\n                ref={inputRef}\n                className=\"ai-chat-widget-input\"\n                placeholder={placeholder}\n                disabled={!canSend}\n                onKeyDown={handleKeyDown}\n                onChange={handleInputChange}\n                value={inputValue}\n                rows={1}\n              />\n              <button\n                className={`ai-chat-widget-send ${!canSend || !inputValue.trim() ? 'disabled' : ''}`}\n                onClick={handleSend}\n                disabled={!canSend || !inputValue.trim()}\n                title=\"Send message\"\n                aria-label=\"Send message\"\n              >\n                {busy ? <IconSpinner /> : <IconSend />}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,cAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,MAAA,GAAAJ,OAAA;AACAA,OAAA;AAA4B,SAAAE,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,SAAAN,wBAAAM,CAAA,EAAAG,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAV,uBAAA,YAAAA,CAAAM,CAAA,EAAAG,CAAA,SAAAA,CAAA,IAAAH,CAAA,IAAAA,CAAA,CAAAC,UAAA,SAAAD,CAAA,MAAAO,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAR,OAAA,EAAAF,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAS,CAAA,MAAAF,CAAA,GAAAJ,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAE,CAAA,CAAAI,GAAA,CAAAX,CAAA,UAAAO,CAAA,CAAAK,GAAA,CAAAZ,CAAA,GAAAO,CAAA,CAAAM,GAAA,CAAAb,CAAA,EAAAS,CAAA,gBAAAN,CAAA,IAAAH,CAAA,gBAAAG,CAAA,OAAAW,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAG,CAAA,OAAAK,CAAA,IAAAD,CAAA,GAAAS,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAG,CAAA,OAAAK,CAAA,CAAAI,GAAA,IAAAJ,CAAA,CAAAK,GAAA,IAAAN,CAAA,CAAAE,CAAA,EAAAN,CAAA,EAAAK,CAAA,IAAAC,CAAA,CAAAN,CAAA,IAAAH,CAAA,CAAAG,CAAA,WAAAM,CAAA,KAAAT,CAAA,EAAAG,CAAA;AAAA,SAAAgB,SAAA,WAAAA,QAAA,GAAAH,MAAA,CAAAI,MAAA,GAAAJ,MAAA,CAAAI,MAAA,CAAAC,IAAA,eAAAf,CAAA,aAAAN,CAAA,MAAAA,CAAA,GAAAsB,SAAA,CAAAC,MAAA,EAAAvB,CAAA,UAAAG,CAAA,GAAAmB,SAAA,CAAAtB,CAAA,YAAAK,CAAA,IAAAF,CAAA,OAAAW,cAAA,CAAAC,IAAA,CAAAZ,CAAA,EAAAE,CAAA,MAAAC,CAAA,CAAAD,CAAA,IAAAF,CAAA,CAAAE,CAAA,aAAAC,CAAA,KAAAa,QAAA,CAAAK,KAAA,OAAAF,SAAA;AAE5B;AACA,MAAMG,OAAO,GAAGC,IAAA;EAAA,IAAC;IAAEC,IAAI,GAAG,EAAE;IAAE,GAAGC;EAAM,CAAC,GAAAF,IAAA;EAAA,oBACtCjC,MAAA,CAAAS,OAAA,CAAA2B,aAAA,QAAAV,QAAA;IAAKW,KAAK,EAAEH,IAAK;IAACI,MAAM,EAAEJ,IAAK;IAACK,OAAO,EAAC,WAAW;IAACC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,cAAc;IAACC,WAAW,EAAC,KAAK;IAACC,aAAa,EAAC,OAAO;IAACC,cAAc,EAAC,OAAO;IAAC,eAAY;EAAM,GAAKT,KAAK,gBAC/KnC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMS,CAAC,EAAC,GAAG;IAACC,CAAC,EAAC,GAAG;IAACT,KAAK,EAAC,IAAI;IAACC,MAAM,EAAC,IAAI;IAACS,EAAE,EAAC;EAAG,CAAO,CAAC,eACvD/C,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMY,CAAC,EAAC;EAAS,CAAO,CAAC,eACzBhD,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAQa,EAAE,EAAC,KAAK;IAACC,EAAE,EAAC,MAAM;IAACtC,CAAC,EAAC;EAAG,CAAS,CAAC,eAC1CZ,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAQa,EAAE,EAAC,MAAM;IAACC,EAAE,EAAC,MAAM;IAACtC,CAAC,EAAC;EAAG,CAAS,CACvC,CAAC;AAAA,CACP;AACD,MAAMuC,SAAS,GAAGC,KAAA;EAAA,IAAC;IAAElB,IAAI,GAAG,EAAE;IAAE,GAAGC;EAAM,CAAC,GAAAiB,KAAA;EAAA,oBACxCpD,MAAA,CAAAS,OAAA,CAAA2B,aAAA,QAAAV,QAAA;IAAKW,KAAK,EAAEH,IAAK;IAACI,MAAM,EAAEJ,IAAK;IAACK,OAAO,EAAC,WAAW;IAACC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,cAAc;IAACC,WAAW,EAAC,KAAK;IAACC,aAAa,EAAC,OAAO;IAACC,cAAc,EAAC,OAAO;IAAC,eAAY;EAAM,GAAKT,KAAK,gBAC/KnC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMiB,EAAE,EAAC,IAAI;IAACC,EAAE,EAAC,GAAG;IAACC,EAAE,EAAC,GAAG;IAACC,EAAE,EAAC;EAAI,CAAO,CAAC,eAC3CxD,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMiB,EAAE,EAAC,GAAG;IAACC,EAAE,EAAC,GAAG;IAACC,EAAE,EAAC,IAAI;IAACC,EAAE,EAAC;EAAI,CAAO,CACvC,CAAC;AAAA,CACP;AACD,MAAMC,QAAQ,GAAGC,KAAA;EAAA,IAAC;IAAExB,IAAI,GAAG,EAAE;IAAE,GAAGC;EAAM,CAAC,GAAAuB,KAAA;EAAA,oBACvC1D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,QAAAV,QAAA;IAAKW,KAAK,EAAEH,IAAK;IAACI,MAAM,EAAEJ,IAAK;IAACK,OAAO,EAAC,WAAW;IAACC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,cAAc;IAACC,WAAW,EAAC,KAAK;IAACC,aAAa,EAAC,OAAO;IAACC,cAAc,EAAC,OAAO;IAAC,eAAY;EAAM,GAAKT,KAAK,gBAC/KnC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMY,CAAC,EAAC;EAAa,CAAO,CAAC,eAC7BhD,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMY,CAAC,EAAC;EAA6B,CAAO,CACzC,CAAC;AAAA,CACP;AACD,MAAMW,WAAW,GAAGC,KAAA;EAAA,IAAC;IAAE1B,IAAI,GAAG,EAAE;IAAE,GAAGC;EAAM,CAAC,GAAAyB,KAAA;EAAA,oBAC1C5D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,QAAAV,QAAA;IAAKmC,SAAS,EAAC,SAAS;IAACxB,KAAK,EAAEH,IAAK;IAACI,MAAM,EAAEJ,IAAK;IAACK,OAAO,EAAC,WAAW;IAAC,eAAY;EAAM,GAAKJ,KAAK,gBAClGnC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAQa,EAAE,EAAC,IAAI;IAACC,EAAE,EAAC,IAAI;IAACtC,CAAC,EAAC,IAAI;IAAC6B,MAAM,EAAC,cAAc;IAACC,WAAW,EAAC,GAAG;IAACF,IAAI,EAAC,MAAM;IAACsB,OAAO,EAAC;EAAK,CAAE,CAAC,eACjG9D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMY,CAAC,EAAC,0BAA0B;IAACP,MAAM,EAAC,cAAc;IAACC,WAAW,EAAC,GAAG;IAACF,IAAI,EAAC;EAAM,CAAE,CACnF,CAAC;AAAA,CACP;;AAED;AACA;AACA;AACA;AACA;AACe,SAASuB,YAAYA,CAAAC,KAAA,EAEjC;EAAA,IAFkC;IACnCC,WAAW,GAAG,CAAC;EACjB,CAAC,GAAAD,KAAA;EACC,MAAM;IACJE,KAAK,GAAG,cAAc;IACtBC,WAAW,GAAG,kBAAkB;IAChCC,MAAM,GAAG,wBAAwB;IACjCC,QAAQ,GAAG;EACb,CAAC,GAAGJ,WAAW;EAEf,MAAM;IAAEK,WAAW;IAAEC,iBAAiB;IAAEC,SAAS;IAAEC;EAAM,CAAC,GAAG,IAAAC,gBAAS,EAACN,MAAM,CAAC;EAC9E,MAAM,CAACO,IAAI,EAAEC,OAAO,CAAC,GAAG,IAAAC,eAAQ,EAAC,KAAK,CAAC;EACvC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAG,IAAAF,eAAQ,EAAC,KAAK,CAAC;EACvC,MAAM,CAACG,KAAK,EAAEC,QAAQ,CAAC,GAAG,IAAAJ,eAAQ,EAAC,EAAE,CAAC;EACtC,MAAM,CAACK,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG,IAAAN,eAAQ,EAAC,IAAI,CAAC;EAClE,MAAM,CAACO,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG,IAAAR,eAAQ,EAAC,KAAK,CAAC;EACnE,MAAMS,QAAQ,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EAC7B,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAG,IAAAZ,eAAQ,EAAC,EAAE,CAAC;EAChD,MAAMa,cAAc,GAAG,IAAAH,aAAM,EAAC,IAAI,CAAC;EAEnC,MAAMI,OAAO,GAAG,IAAAC,cAAO,EAAC,MAAM,CAACvB,QAAQ,IAAI,CAACS,IAAI,EAAE,CAACT,QAAQ,EAAES,IAAI,CAAC,CAAC;;EAEnE;EACA,MAAMe,kBAAkB,GAAG;IACzB;IACAC,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAEC;MAAS,CAAC,GAAAD,KAAA;MAAA,oBAAK/F,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEC,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAEF;MAAS,CAAC,GAAAE,KAAA;MAAA,oBAAKlG,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEG,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAEJ;MAAS,CAAC,GAAAI,KAAA;MAAA,oBAAKpG,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEK,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAEN;MAAS,CAAC,GAAAM,KAAA;MAAA,oBAAKtG,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEO,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAER;MAAS,CAAC,GAAAQ,KAAA;MAAA,oBAAKxG,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjES,EAAE,EAAEC,KAAA;MAAA,IAAC;QAAEV;MAAS,CAAC,GAAAU,KAAA;MAAA,oBAAK1G,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjE;IACAW,IAAI,EAAEC,MAAA;MAAA,IAAC;QAAEZ,QAAQ;QAAEnC;MAAU,CAAC,GAAA+C,MAAA;MAAA,oBAC5B5G,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAMyB,SAAS,EAAE,iBAAiBA,SAAS,IAAI,EAAE;MAAG,GAAEmC,QAAe,CAAC;IAAA,CACvE;IACD;IACAa,EAAE,EAAEC,MAAA;MAAA,IAAC;QAAEd;MAAS,CAAC,GAAAc,MAAA;MAAA,oBAAK9G,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEe,EAAE,EAAEC,MAAA;MAAA,IAAC;QAAEhB;MAAS,CAAC,GAAAgB,MAAA;MAAA,oBAAKhH,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjEiB,EAAE,EAAEC,MAAA;MAAA,IAAC;QAAElB;MAAS,CAAC,GAAAkB,MAAA;MAAA,oBAAKlH,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAIyB,SAAS,EAAC;MAAa,GAAEmC,QAAa,CAAC;IAAA;IACjE;IACAmB,CAAC,EAAEC,MAAA;MAAA,IAAC;QAAEpB;MAAS,CAAC,GAAAoB,MAAA;MAAA,oBAAKpH,MAAA,CAAAS,OAAA,CAAA2B,aAAA;QAAGyB,SAAS,EAAC;MAAY,GAAEmC,QAAY,CAAC;IAAA;EAC/D,CAAC;;EAED;EACA,MAAMqB,cAAc,GAAGA,CAAA,KAAM;IAC3B3B,cAAc,CAAC4B,OAAO,EAAEC,cAAc,CAAC;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EAChE,CAAC;EAED,IAAAC,gBAAS,EAAC,MAAM;IACdJ,cAAc,CAAC,CAAC;EAClB,CAAC,EAAE,CAACrC,KAAK,EAAEF,IAAI,CAAC,CAAC;EAEjB,SAAS4C,MAAMA,CAACC,IAAI,EAA8B;IAAA,IAA5BC,IAAI,GAAA/F,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAgG,SAAA,GAAAhG,SAAA,MAAG,QAAQ;IAAA,IAAEiG,EAAE,GAAAjG,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAgG,SAAA,GAAAhG,SAAA,MAAG,IAAI;IAC9C,MAAMkG,SAAS,GAAGD,EAAE,IAAIE,MAAM,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC;IAC1DnD,QAAQ,CAACoD,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE;MAAEP,EAAE,EAAEC,SAAS;MAAEH,IAAI;MAAED;IAAK,CAAC,CAAC,CAAC;IAC1D,OAAOI,SAAS;EAClB;EAEA,SAASO,aAAaA,CAACR,EAAE,EAAEH,IAAI,EAAE;IAC/B1C,QAAQ,CAACoD,IAAI,IAAIA,IAAI,CAACE,GAAG,CAACC,IAAI,IAC5BA,IAAI,CAACV,EAAE,KAAKA,EAAE,GAAG;MAAE,GAAGU,IAAI;MAAEb;IAAK,CAAC,GAAGa,IACvC,CAAC,CAAC;EACJ;EAEA,SAASC,cAAcA,CAACC,GAAG,EAAE;IAC3B,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;MAC3B,OAAOA,GAAG;IACZ;;IAEA;IACA,IAAIA,GAAG,EAAEC,OAAO,EAAE;MAChB,OAAOD,GAAG,CAACC,OAAO;IACpB;;IAEA;IACA,IAAID,GAAG,EAAEE,QAAQ,EAAEnE,KAAK,EAAE;MACxB,OAAOiE,GAAG,CAACE,QAAQ,CAACnE,KAAK;IAC3B;;IAEA;IACA,OAAOiE,GAAG,EAAEf,IAAI,IAAIkB,IAAI,CAACC,SAAS,CAACJ,GAAG,CAAC;EACzC;EAEA,SAASK,WAAWA,CAACtE,KAAK,EAAE;IAC1B;IACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;MAC7B,OAAOA,KAAK;IACd;IAEA,IAAIA,KAAK,EAAEkE,OAAO,EAAE;MAClB,OAAOlE,KAAK,CAACkE,OAAO;IACtB;IAEA,IAAIlE,KAAK,EAAEuE,MAAM,EAAE;MACjB,OAAOvE,KAAK,CAACuE,MAAM;IACrB;IAEA,OAAO,yCAAyC;EAClD;EAEA,eAAeC,UAAUA,CAAA,EAAG;IAC1B,MAAMC,CAAC,GAAG1D,UAAU,CAAC2D,IAAI,CAAC,CAAC;IAC3B,IAAI,CAACD,CAAC,IAAI,CAACvD,OAAO,EAAE;;IAEpB;IACA+B,MAAM,CAACwB,CAAC,EAAE,MAAM,CAAC;IACjBzD,aAAa,CAAC,EAAE,CAAC;IACjBV,OAAO,CAAC,IAAI,CAAC;IAEb,IAAI;MACF;MACA,IAAIR,iBAAiB,EAAE;QACrB,MAAM6E,kBAAkB,GAAG1B,MAAM,CAAC,EAAE,EAAE,WAAW,CAAC;QAClDvC,qBAAqB,CAACiE,kBAAkB,CAAC;QACzC,IAAIC,YAAY,GAAG,EAAE;QAErB,MAAM9E,iBAAiB,CAAC2E,CAAC,EAAGI,KAAK,IAAK;UACpCD,YAAY,IAAIC,KAAK;UACrBhB,aAAa,CAACc,kBAAkB,EAAEC,YAAY,CAAC;QACjD,CAAC,CAAC;QAEFlE,qBAAqB,CAAC,IAAI,CAAC;QAC3BE,qBAAqB,CAAC,IAAI,CAAC;MAC7B,CAAC,MAAM;QACL;QACA,MAAMqD,GAAG,GAAG,MAAMpE,WAAW,CAAC4E,CAAC,CAAC;QAChC,MAAMvB,IAAI,GAAGc,cAAc,CAACC,GAAG,CAAC;QAChChB,MAAM,CAACC,IAAI,EAAE,WAAW,CAAC;QACzBtC,qBAAqB,CAAC,IAAI,CAAC;MAC7B;IACF,CAAC,CAAC,OAAO9E,CAAC,EAAE;MACV,MAAMgJ,YAAY,GAAGR,WAAW,CAACxI,CAAC,CAAC;MACnCmH,MAAM,CAAC6B,YAAY,EAAE,OAAO,CAAC;MAC7BpE,qBAAqB,CAAC,IAAI,CAAC;IAC7B,CAAC,SAAS;MACRJ,OAAO,CAAC,KAAK,CAAC;IAChB;EACF;EAEA,SAASyE,aAAaA,CAACjJ,CAAC,EAAE;IACxB,IAAIA,CAAC,CAACkJ,GAAG,KAAK,OAAO,IAAI,CAAClJ,CAAC,CAACmJ,QAAQ,EAAE;MACpCnJ,CAAC,CAACoJ,cAAc,CAAC,CAAC;MAClBV,UAAU,CAAC,CAAC;IACd;EACF;EAEA,SAASW,iBAAiBA,CAACrJ,CAAC,EAAE;IAC5BkF,aAAa,CAAClF,CAAC,CAACsJ,MAAM,CAACC,KAAK,CAAC;IAC7B;IACA,MAAMC,QAAQ,GAAGxJ,CAAC,CAACsJ,MAAM;IACzBE,QAAQ,CAACC,KAAK,CAAC1H,MAAM,GAAG,MAAM;IAC9ByH,QAAQ,CAACC,KAAK,CAAC1H,MAAM,GAAG6F,IAAI,CAAC8B,GAAG,CAACF,QAAQ,CAACG,YAAY,EAAE,GAAG,CAAC,GAAG,IAAI;EACrE;EAEA,IAAI,CAACvF,IAAI,EAAE;IACT,oBACE3E,MAAA,CAAAS,OAAA,CAAA2B,aAAA;MAAKyB,SAAS,EAAC;IAAoB,gBACjC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;MACEyB,SAAS,EAAC,2BAA2B;MACrCsG,OAAO,EAAEA,CAAA,KAAMvF,OAAO,CAAC,IAAI,CAAE;MAC7BV,KAAK,EAAEA,KAAM;MACb,cAAY,QAAQA,KAAK;IAAG,gBAE5BlE,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACJ,OAAO;MAACE,IAAI,EAAE;IAAG,CAAE,CACd,CACL,CAAC;EAEV;EAEA,oBACElC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAA0B,gBACvC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAgB,gBAC7B7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAuB,gBACpC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAA8B,gBAC3C7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAqB,gBAAC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACJ,OAAO;IAACE,IAAI,EAAE;EAAG,CAAE,CAAM,CAAC,eAChElC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAIyB,SAAS,EAAC;EAAsB,GAAEK,KAAU,CAC7C,CAAC,eACNlE,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IACEyB,SAAS,EAAC,sBAAsB;IAChCsG,OAAO,EAAEA,CAAA,KAAMvF,OAAO,CAAC,KAAK,CAAE;IAC9BV,KAAK,EAAC,OAAO;IACb,cAAW;EAAY,gBAEvBlE,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACe,SAAS;IAACjB,IAAI,EAAE;EAAG,CAAE,CAChB,CACL,CAAC,eAENlC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAqB,GACjCmB,KAAK,CAAClD,MAAM,KAAK,CAAC,iBACjB9B,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAwB,gBACrC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAc,gBAAC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACJ,OAAO;IAACE,IAAI,EAAE;EAAG,CAAE,CAAM,CAAC,eACzDlC,MAAA,CAAAS,OAAA,CAAA2B,aAAA,YAAG,wCAAyC,CACzC,CACN,EACA4C,KAAK,CAACuD,GAAG,CAACC,IAAI,iBACbxI,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKqH,GAAG,EAAEjB,IAAI,CAACV,EAAG;IAACjE,SAAS,EAAE,2CAA2C2E,IAAI,CAACZ,IAAI;EAAG,gBACnF5H,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAiB,gBAC9B7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAAC/B,cAAA,CAAAI,OAAa;IAAC2J,UAAU,EAAEvE;EAAmB,GAC3C2C,IAAI,CAACb,IAAI,IAAI,EACD,CACZ,CAAC,EACLzC,kBAAkB,KAAKsD,IAAI,CAACV,EAAE,iBAC7B9H,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAMyB,SAAS,EAAC;EAAkB,GAAC,QAAO,CAEzC,CACN,CAAC,EACDiB,IAAI,IAAI,CAACI,kBAAkB,iBAC1BlF,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAyE,gBACtF7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAkB,gBAC/B7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,aAAY,CAAC,eACbpC,MAAA,CAAAS,OAAA,CAAA2B,aAAA,aAAY,CAAC,eACbpC,MAAA,CAAAS,OAAA,CAAA2B,aAAA,aAAY,CACT,CAAC,eAEH,CACN,EACAgD,kBAAkB,iBACjBpF,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAA2B,gBACxC7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,YAAG,iFAEA,CACA,CACN,eACDpC,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKiI,GAAG,EAAE3E;EAAe,CAAE,CACxB,CAAC,eAEN1F,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAuB,GACnCY,KAAK,iBACJzE,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAsB,GAClCY,KACE,CACN,eACDzE,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAAgC,gBAC7C7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IAAKyB,SAAS,EAAC;EAA8B,gBAC3C7D,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IACEiI,GAAG,EAAE/E,QAAS;IACdzB,SAAS,EAAC,sBAAsB;IAChCM,WAAW,EAAEA,WAAY;IACzBE,QAAQ,EAAE,CAACsB,OAAQ;IACnB2E,SAAS,EAAEd,aAAc;IACzBe,QAAQ,EAAEX,iBAAkB;IAC5BE,KAAK,EAAEtE,UAAW;IAClBgF,IAAI,EAAE;EAAE,CACT,CAAC,eACFxK,MAAA,CAAAS,OAAA,CAAA2B,aAAA;IACEyB,SAAS,EAAE,uBAAuB,CAAC8B,OAAO,IAAI,CAACH,UAAU,CAAC2D,IAAI,CAAC,CAAC,GAAG,UAAU,GAAG,EAAE,EAAG;IACrFgB,OAAO,EAAElB,UAAW;IACpB5E,QAAQ,EAAE,CAACsB,OAAO,IAAI,CAACH,UAAU,CAAC2D,IAAI,CAAC,CAAE;IACzCjF,KAAK,EAAC,cAAc;IACpB,cAAW;EAAc,GAExBY,IAAI,gBAAG9E,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACuB,WAAW,MAAE,CAAC,gBAAG3D,MAAA,CAAAS,OAAA,CAAA2B,aAAA,CAACqB,QAAQ,MAAE,CAC/B,CACL,CACF,CACF,CACF,CACF,CAAC;AAEV","ignoreList":[]}